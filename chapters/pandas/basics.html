
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.2. Basic Functionality &#8212; Quantitative Investing</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/book.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://amoreira2.github.io/quantitativeinvesting/chapters/pandas/basics.html" />
    <link rel="shortcut icon" href="../../_static/figuremain2.jpg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.3. The Index" href="the_index.html" />
    <link rel="prev" title="6.1. Introduction" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/figuremain2.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Quantitative Investing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/what-is-quant-investing.html">
   1. What is Quantitative Investing?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/statistical-techniques.html">
     1.1. Statistical Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/computational-tools.html">
     1.2. Computational tools
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/getting_started.html">
   2. Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/local_install.html">
     2.2.1. Local installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/cloud_setup.html">
     2.2.2. Cloud Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/programming-in-python.html">
   3. First Steps with Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/1/Expressions.html">
     3.1. Expressions
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/2/Names.html">
     3.2. Names
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/2/1/Growth.html">
       3.2.1. Example: Growth Rates
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/3/Calls.html">
     3.3. Call Expressions
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/4/Data_Types.html">
     3.4. Data Types
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/4/1/Numbers.html">
       3.4.1. Numbers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/4/2/Strings.html">
       3.4.2. Strings
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/5/Sequences.html">
     3.5. Sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/1/Arrays.html">
       3.5.1. Arrays
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/2/Ranges.html">
       3.5.2. Ranges
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/3/More_on_Arrays.html">
       3.5.3. More on Arrays
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../essentials/essentials.html">
   4. Python Essentials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/basics.html">
     4.1. Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/collections.html">
     4.2. Collections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/control_flow.html">
     4.3. Flow control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/functions.html">
     4.4. Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../scientific/intro.html">
   5. Scientific Computing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/numpy1.html">
     5.1. Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/plotting1.html">
     5.2. Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/linear_algebra1.html">
     5.3. Linear algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/randomness1.html">
     5.4. Randomness
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="workingwithdata.html">
   6. Working with Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro.html">
     6.1. Introduction
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.2. Pandas Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="the_index.html">
     6.3. Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data_clean.html">
     6.4. Cleaning data (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reshape.html">
     6.5. Reshape (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="merge.html">
     6.6. Merge (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="groupby.html">
     6.7. Group-by (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="timeseries.html">
     6.8. Time-Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="matplotlib.html">
     6.9. Plotting (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="storage_formats.html">
     6.10. Data Storage (opt)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Returns.html">
   7. Asset Returns
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/TheChoiceofFrequency.html">
     7.1. The Choice of Frequency and Annualization of Returns
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/PortfolioMath.html">
   8. Portfolio Math
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/CapitalAllocationLine.html">
   9. Capital Allocation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/UsingAPI.html">
     9.1. Using APIs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/MeanVariance.html">
   10. Mean Variance Efficient Portfolios
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/CaseStudy.html">
     10.1. Case Study in International Diversification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/LeverageandShorting.html">
     10.2. Leverage and Shorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Portfoliooptimizationwithconstraints.html">
     10.3. Portfolio Optimization with constraints
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/EstimationUncertainty.html">
   11. Estimation Uncertainty and It's Implications for investing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/TradingStrategies.html">
   12. Trading Strategies
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Timing.html">
   13. Timing Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Volatilitytiming.html">
     13.1. Volatility Timing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/crosssectionalequitystrategies.html">
   14. Cross-Sectional Equity Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Valueinvesting.html">
     14.1. Value
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Momentum.html">
     14.2. Momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/OtherEquityStrategies.html">
     14.3. Other Equity strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Evaluation.html">
   15. Evaluating a Trading Strategy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Econometrics.html">
     15.1. The Econometrics of Strategy Evalaution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/outofsample.html">
     15.2. Out of Sample Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/TailandBackground.html">
     15.3. Tail Risks and Background Risks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Topics.html">
   16. Topics in Quantitative Investing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/MultiFactorModels.html">
     16.1. Multifactor Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Equilbrium.html">
     16.2. Intepreting Factor models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Implementation.html">
     16.3. Strategy Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Horizon.html">
     16.4. Investment horizon effects
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../additional/additional.html">
   17. Additional Statistics Material
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/10/Sampling_and_Empirical_Distributions.html">
     17.1.1. Sampling and Empirical Distributions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/1/Empirical_Distributions.html">
       17.1.1.1. Empirical Distributions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/2/Sampling_from_a_Population.html">
       17.1.1.2. Sampling from a Population
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/3/Empirical_Distribution_of_a_Statistic.html">
       17.1.1.3. Empirical Distibution of a Statistic
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/11/Testing_Hypotheses.html">
     17.1.2. Testing Hypotheses
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/1/Assessing_Models.html">
       17.1.2.1. Assessing Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/2/Multiple_Categories.html">
       17.1.2.2. Multiple Categories
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/3/Decisions_and_Uncertainty.html">
       17.1.2.3. Decisions and Uncertainty
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/4/Error_Probabilities.html">
       17.1.2.4. Error Probabilities
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/13/Estimation.html">
     17.1.3. Estimation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/1/Percentiles.html">
       17.1.3.1. Percentiles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/2/Bootstrap.html">
       17.1.3.2. The Bootstrap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/3/Confidence_Intervals.html">
       17.1.3.3. Confidence Intervals
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/4/Using_Confidence_Intervals.html">
       17.1.3.4. Using Confidence Intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/14/Why_the_Mean_Matters.html">
     17.1.4. Why the Mean Matters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/1/Properties_of_the_Mean.html">
       17.1.4.1. Properties of the Mean
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/2/Variability.html">
       17.1.4.2. Variability
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/3/SD_and_the_Normal_Curve.html">
       17.1.4.3. The SD and the Normal Curve
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/4/Central_Limit_Theorem.html">
       17.1.4.4. The Central Limit Theorem
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/5/Variability_of_the_Sample_Mean.html">
       17.1.4.5. The Variability of the Sample Mean
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/6/Choosing_a_Sample_Size.html">
       17.1.4.6. Choosing a Sample Size
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/15/Prediction.html">
     17.1.5. Prediction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/1/Correlation.html">
       17.1.5.1. Correlation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/2/Regression_Line.html">
       17.1.5.2. The Regression Line
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/3/Method_of_Least_Squares.html">
       17.1.5.3. The Method of Least Squares
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/4/Least_Squares_Regression.html">
       17.1.5.4. Least Squares Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/5/Visual_Diagnostics.html">
       17.1.5.5. Visual Diagnostics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/6/Numerical_Diagnostics.html">
       17.1.5.6. Numerical Diagnostics
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/16/Inference_for_Regression.html">
     17.1.6. Inference for Regression
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/1/Regression_Model.html">
       17.1.6.1. A Regression Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/2/Inference_for_the_True_Slope.html">
       17.1.6.2. Inference for the True Slope
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/3/Prediction_Intervals.html">
       17.1.6.3. Prediction Intervals
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/pandas/basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/amoreira2/Lectures"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/amoreira2/Lectures/issues/new?title=Issue%20on%20page%20%2Fchapters/pandas/basics.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/amoreira2/Lectures/main?urlpath=lab/tree/chapters/pandas/basics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://pims.syzygy.ca/jupyter/hub/user-redirect/git-pull?repo=https://github.com/amoreira2/Lectures&urlpath=lab/tree/Lectures/chapters/pandas/basics.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/amoreira2/Lectures/blob/main/chapters/pandas/basics.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outline">
   6.2.1. Outline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#state-unemployment-data">
   6.2.2. State Unemployment Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dates-in-pandas">
   6.2.3. Dates in pandas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataframe-aggregations">
   6.2.4. DataFrame Aggregations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#built-in-aggregations">
     6.2.4.1. Built-in Aggregations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-your-own-aggregation">
     6.2.4.2. Writing Your Own Aggregation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transforms">
   6.2.5. Transforms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#built-in-transforms">
     6.2.5.1. Built-in Transforms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-series-transforms">
     6.2.5.2. Custom Series Transforms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-scalar-transforms">
     6.2.5.3. Custom Scalar Transforms
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boolean-selection">
   6.2.6. Boolean Selection
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-boolean-dataframes-series">
     6.2.6.1. Creating Boolean DataFrames/Series
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-conditions">
       6.2.6.1.1. Multiple Conditions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#isin">
       6.2.6.1.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         isin
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#any-and-all">
       6.2.6.1.3.
       <code class="docutils literal notranslate">
        <span class="pre">
         .any
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         .all
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   6.2.7. Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="basic-functionality">
<h1><span class="section-number">6.2. </span>Basic Functionality<a class="headerlink" href="#basic-functionality" title="Permalink to this headline">¶</a></h1>
<p><strong>Outcomes</strong></p>
<ul class="simple">
<li><p>Be familiar with <code class="docutils literal notranslate"><span class="pre">datetime</span></code></p></li>
<li><p>Use built-in aggregation functions and be able to create your own and
apply them using <code class="docutils literal notranslate"><span class="pre">agg</span></code></p></li>
<li><p>Use built-in Series transformation functions and be able to create your
own and apply them using <code class="docutils literal notranslate"><span class="pre">apply</span></code></p></li>
<li><p>Use built-in scalar transformation functions and be able to create your
own and apply them using <code class="docutils literal notranslate"><span class="pre">applymap</span></code></p></li>
<li><p>Be able to select subsets of the DataFrame using boolean selection</p></li>
<li><p>Know what the “want operator” is and how to apply it</p></li>
</ul>
<p><strong>Data</strong></p>
<ul class="simple">
<li><p>US state unemployment data from Bureau of Labor Statistics</p></li>
</ul>
<div class="section" id="outline">
<h2><span class="section-number">6.2.1. </span>Outline<a class="headerlink" href="#outline" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Basic-Functionality">Basic Functionality</a></p>
<ul>
<li><p><a class="reference external" href="#State-Unemployment-Data">State Unemployment Data</a></p></li>
<li><p><a class="reference external" href="#Dates-in-pandas">Dates in pandas</a></p></li>
<li><p><a class="reference external" href="#DataFrame-Aggregations">DataFrame Aggregations</a></p></li>
<li><p><a class="reference external" href="#Transforms">Transforms</a></p></li>
<li><p><a class="reference external" href="#Boolean-Selection">Boolean Selection</a></p></li>
<li><p><a class="reference external" href="#Exercises">Exercises</a></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment following line to install on colab</span>
<span class="c1">#! pip install qeds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="state-unemployment-data">
<h2><span class="section-number">6.2.2. </span>State Unemployment Data<a class="headerlink" href="#state-unemployment-data" title="Permalink to this headline">¶</a></h2>
<p>In this lecture, we will use unemployment data by state at a monthly
frequency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># activate plot theme</span>
<span class="kn">import</span> <span class="nn">qeds</span>
<span class="n">qeds</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">mpl_style</span><span class="p">();</span>

<span class="n">pd</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1.2.3&#39;
</pre></div>
</div>
</div>
</div>
<p>First, we will download the data directly from a url and read it into a pandas DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Load up the data -- this will take a couple seconds</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/amoreira2/Lectures/main/assets/data/49_Industry_Portfolios.CSV&quot;</span>
<span class="n">industret_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The pandas <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> will determine most datatypes of the underlying columns.  The
exception here is that we need to give pandas a hint so it can load up the <code class="docutils literal notranslate"><span class="pre">Date</span></code> column as a Python datetime type: the <code class="docutils literal notranslate"><span class="pre">parse_dates=[&quot;Date&quot;]</span></code>.</p>
<p>We can see the basic structure of the downloaded data by getting the first 5 rows, which directly matches
the underlying CSV file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">industret_raw</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>level_1</th>
      <th>returns</th>
      <th>nfirms</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1926-07-31</td>
      <td>Agric</td>
      <td>2.37</td>
      <td>3</td>
      <td>99.80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1926-07-31</td>
      <td>Food</td>
      <td>0.12</td>
      <td>40</td>
      <td>31.19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1926-07-31</td>
      <td>Soda</td>
      <td>-99.99</td>
      <td>0</td>
      <td>-99.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1926-07-31</td>
      <td>Beer</td>
      <td>-5.19</td>
      <td>3</td>
      <td>7.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1926-07-31</td>
      <td>Smoke</td>
      <td>1.29</td>
      <td>16</td>
      <td>59.72</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that a row has a date, state, labor force size, and unemployment rate.</p>
<p>For our analysis, we want to look at the unemployment rate across different states over time, which
requires a transformation of the data similar to an Excel pivot-table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t worry about the details here quite yet</span>
<span class="n">unemp_all</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">unemp_raw</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;UnemploymentRate&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">unemp_all</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Alabama</th>
      <th>Alaska</th>
      <th>Arizona</th>
      <th>Arkansas</th>
      <th>California</th>
      <th>Colorado</th>
      <th>Connecticut</th>
      <th>Delaware</th>
      <th>Florida</th>
      <th>Georgia</th>
      <th>...</th>
      <th>South Dakota</th>
      <th>Tennessee</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>Vermont</th>
      <th>Virginia</th>
      <th>Washington</th>
      <th>West Virginia</th>
      <th>Wisconsin</th>
      <th>Wyoming</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.7</td>
      <td>6.3</td>
      <td>4.1</td>
      <td>4.4</td>
      <td>5.0</td>
      <td>2.8</td>
      <td>2.8</td>
      <td>3.5</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>3.1</td>
      <td>2.7</td>
      <td>2.6</td>
      <td>4.9</td>
      <td>5.8</td>
      <td>3.2</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.7</td>
      <td>6.3</td>
      <td>4.1</td>
      <td>4.3</td>
      <td>5.0</td>
      <td>2.8</td>
      <td>2.7</td>
      <td>3.6</td>
      <td>3.7</td>
      <td>3.6</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>3.1</td>
      <td>2.6</td>
      <td>2.5</td>
      <td>4.9</td>
      <td>5.6</td>
      <td>3.2</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.6</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.3</td>
      <td>5.0</td>
      <td>2.7</td>
      <td>2.6</td>
      <td>3.6</td>
      <td>3.7</td>
      <td>3.6</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>4.5</td>
      <td>3.1</td>
      <td>2.6</td>
      <td>2.4</td>
      <td>5.0</td>
      <td>5.5</td>
      <td>3.3</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.6</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.3</td>
      <td>5.1</td>
      <td>2.7</td>
      <td>2.5</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.8</td>
      <td>4.4</td>
      <td>3.1</td>
      <td>2.7</td>
      <td>2.4</td>
      <td>5.0</td>
      <td>5.4</td>
      <td>3.4</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.5</td>
      <td>6.3</td>
      <td>4.0</td>
      <td>4.2</td>
      <td>5.1</td>
      <td>2.7</td>
      <td>2.4</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>3.7</td>
      <td>...</td>
      <td>2.4</td>
      <td>3.9</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>2.7</td>
      <td>2.3</td>
      <td>5.1</td>
      <td>5.4</td>
      <td>3.5</td>
      <td>3.8</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 50 columns</p>
</div></div></div>
</div>
<p>Finally, we can filter it to look at a subset of the columns (i.e. “state” in this case).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Arizona&quot;</span><span class="p">,</span> <span class="s2">&quot;California&quot;</span><span class="p">,</span> <span class="s2">&quot;Florida&quot;</span><span class="p">,</span> <span class="s2">&quot;Illinois&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Michigan&quot;</span><span class="p">,</span> <span class="s2">&quot;New York&quot;</span><span class="p">,</span> <span class="s2">&quot;Texas&quot;</span>
<span class="p">]</span>
<span class="n">unemp</span> <span class="o">=</span> <span class="n">unemp_all</span><span class="p">[</span><span class="n">states</span><span class="p">]</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When plotting, a DataFrame knows the column and index names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff0f904e2b0&gt;
</pre></div>
</div>
<img alt="../../_images/basics_14_1.png" src="../../_images/basics_14_1.png" />
</div>
</div>
<p><a id='exercise-0'></a></p>
<blockquote>
<div><p>See exercise 1 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
<div class="section" id="dates-in-pandas">
<h2><span class="section-number">6.2.3. </span>Dates in pandas<a class="headerlink" href="#dates-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>You might have noticed that our index now has a nice format for the
dates (<code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>) rather than just a year.</p>
<p>This is because the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the index is a variant of <code class="docutils literal notranslate"><span class="pre">datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-02-01&#39;, &#39;2000-03-01&#39;, &#39;2000-04-01&#39;,
               &#39;2000-05-01&#39;, &#39;2000-06-01&#39;, &#39;2000-07-01&#39;, &#39;2000-08-01&#39;,
               &#39;2000-09-01&#39;, &#39;2000-10-01&#39;,
               ...
               &#39;2017-03-01&#39;, &#39;2017-04-01&#39;, &#39;2017-05-01&#39;, &#39;2017-06-01&#39;,
               &#39;2017-07-01&#39;, &#39;2017-08-01&#39;, &#39;2017-09-01&#39;, &#39;2017-10-01&#39;,
               &#39;2017-11-01&#39;, &#39;2017-12-01&#39;],
              dtype=&#39;datetime64[ns]&#39;, name=&#39;Date&#39;, length=216, freq=None)
</pre></div>
</div>
</div>
</div>
<p>We can index into a DataFrame with a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> using string
representations of dates.</p>
<p>For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data corresponding to a single date</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;01/01/2000&quot;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona       4.1
California    5.0
Florida       3.7
Illinois      4.2
Michigan      3.3
New York      4.7
Texas         4.6
Name: 2000-01-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data for all days between New Years Day and June first in the year 2000</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;01/01/2000&quot;</span><span class="p">:</span><span class="s2">&quot;06/01/2000&quot;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
    <tr>
      <th>2000-06-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.8</td>
      <td>4.3</td>
      <td>3.7</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We will learn more about what pandas can do with dates and times in an
upcoming lecture on time series data.</p>
</div>
<div class="section" id="dataframe-aggregations">
<h2><span class="section-number">6.2.4. </span>DataFrame Aggregations<a class="headerlink" href="#dataframe-aggregations" title="Permalink to this headline">¶</a></h2>
<p>Let’s talk about <em>aggregations</em>.</p>
<p>Loosely speaking, an aggregation is an operation that combines multiple
values into a single value.</p>
<p>For example, computing the mean of three numbers (for example
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></code>) returns a single number (1).</p>
<p>We will use aggregations extensively as we analyze and manipulate our data.</p>
<p>Thankfully, pandas makes this easy!</p>
<div class="section" id="built-in-aggregations">
<h3><span class="section-number">6.2.4.1. </span>Built-in Aggregations<a class="headerlink" href="#built-in-aggregations" title="Permalink to this headline">¶</a></h3>
<p>pandas already has some of the most frequently used aggregations.</p>
<p>For example:</p>
<ul class="simple">
<li><p>Mean  (<code class="docutils literal notranslate"><span class="pre">mean</span></code>)</p></li>
<li><p>Variance (<code class="docutils literal notranslate"><span class="pre">var</span></code>)</p></li>
<li><p>Standard deviation (<code class="docutils literal notranslate"><span class="pre">std</span></code>)</p></li>
<li><p>Minimum (<code class="docutils literal notranslate"><span class="pre">min</span></code>)</p></li>
<li><p>Median (<code class="docutils literal notranslate"><span class="pre">median</span></code>)</p></li>
<li><p>Maximum (<code class="docutils literal notranslate"><span class="pre">max</span></code>)</p></li>
<li><p>etc…</p></li>
</ul>
<blockquote>
<div><p><strong>Note</strong></p>
<p>When looking for common operations, using “tab completion” goes a long way.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona       6.301389
California    7.299074
Florida       6.048611
Illinois      6.822685
Michigan      7.492593
New York      6.102315
Texas         5.695370
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As seen above, the aggregation’s default is to aggregate each column.</p>
<p>However, by using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> keyword argument, you can do aggregations by
row as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    0.352381
2000-02-01    0.384762
2000-03-01    0.364762
2000-04-01    0.353333
2000-05-01    0.294762
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="writing-your-own-aggregation">
<h3><span class="section-number">6.2.4.2. </span>Writing Your Own Aggregation<a class="headerlink" href="#writing-your-own-aggregation" title="Permalink to this headline">¶</a></h3>
<p>The built-in aggregations will get us pretty far in our analysis, but
sometimes we need more flexibility.</p>
<p>We can have pandas perform custom aggregations by following these two
steps:</p>
<ol class="simple">
<li><p>Write a Python function that takes a <code class="docutils literal notranslate"><span class="pre">Series</span></code> as an input and
outputs a single value.</p></li>
<li><p>Call the <code class="docutils literal notranslate"><span class="pre">agg</span></code> method with our new function as an argument.</p></li>
</ol>
<p>For example, below, we will classify states as “low unemployment” or
“high unemployment” based on whether their mean unemployment level is
above or below 6.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 1: We write the (aggregation) function that we&#39;d like to use</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">high_or_low</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes a pandas Series object and returns high</span>
<span class="sd">    if the mean is above 6.5 and low if the mean is below 6.5</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">6.5</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;Low&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;High&quot;</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 2: Apply it via the agg method.</span>
<span class="c1">#</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">high_or_low</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona        Low
California    High
Florida        Low
Illinois      High
Michigan      High
New York       Low
Texas          Low
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How does this differ from unemp.agg(high_or_low)?</span>
<span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">high_or_low</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    Low
2000-02-01    Low
2000-03-01    Low
2000-04-01    Low
2000-05-01    Low
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">agg</span></code> can also accept multiple functions at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">high_or_low</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>3.6</td>
      <td>4.5</td>
      <td>3.1</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.2</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>max</th>
      <td>10.9</td>
      <td>12.3</td>
      <td>11.3</td>
      <td>11.3</td>
      <td>14.6</td>
      <td>8.9</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>high_or_low</th>
      <td>Low</td>
      <td>High</td>
      <td>Low</td>
      <td>High</td>
      <td>High</td>
      <td>Low</td>
      <td>Low</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='exercise-1'></a></p>
<blockquote>
<div><p>See exercise 2 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
</div>
<div class="section" id="transforms">
<h2><span class="section-number">6.2.5. </span>Transforms<a class="headerlink" href="#transforms" title="Permalink to this headline">¶</a></h2>
<p>Many analytical operations do not necessarily involve an aggregation.</p>
<p>The output of a function applied to a Series might need to be a new
Series.</p>
<p>Some examples:</p>
<ul class="simple">
<li><p>Compute the percentage change in unemployment from month to month.</p></li>
<li><p>Calculate the cumulative sum of elements in each column.</p></li>
</ul>
<div class="section" id="built-in-transforms">
<h3><span class="section-number">6.2.5.1. </span>Built-in Transforms<a class="headerlink" href="#built-in-transforms" title="Permalink to this headline">¶</a></h3>
<p>pandas comes with many transform functions including:</p>
<ul class="simple">
<li><p>Cumulative sum/max/min/product (<code class="docutils literal notranslate"><span class="pre">cum(sum|min|max|prod)</span></code>)</p></li>
<li><p>Difference  (<code class="docutils literal notranslate"><span class="pre">diff</span></code>)</p></li>
<li><p>Elementwise addition/subtraction/multiplication/division (<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>)</p></li>
<li><p>Percent change (<code class="docutils literal notranslate"><span class="pre">pct_change</span></code>)</p></li>
<li><p>Number of occurrences of each distinct value (<code class="docutils literal notranslate"><span class="pre">value_counts</span></code>)</p></li>
<li><p>Absolute value (<code class="docutils literal notranslate"><span class="pre">abs</span></code>)</p></li>
</ul>
<p>Again, tab completion is helpful when trying to find these functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>0.00000</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>-0.030303</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-0.02439</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.02381</td>
      <td>0.000000</td>
      <td>-0.021277</td>
      <td>-0.021739</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>0.00000</td>
      <td>0.02</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.031250</td>
      <td>0.000000</td>
      <td>-0.022222</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>0.00000</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.060606</td>
      <td>0.000000</td>
      <td>-0.022727</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.1</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>-0.1</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>-0.1</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>-0.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Transforms can be split into to several main categories:</p>
<ol class="simple">
<li><p><em>Series transforms</em>: functions that take in one Series and produce another Series. The index of the input and output does not need to be the same.</p></li>
<li><p><em>Scalar transforms</em>: functions that take a single value and produce a single value. An example is the <code class="docutils literal notranslate"><span class="pre">abs</span></code> method, or adding a constant to each value of a Series.</p></li>
</ol>
</div>
<div class="section" id="custom-series-transforms">
<h3><span class="section-number">6.2.5.2. </span>Custom Series Transforms<a class="headerlink" href="#custom-series-transforms" title="Permalink to this headline">¶</a></h3>
<p>pandas also simplifies applying custom Series transforms to a Series or the
columns of a DataFrame. The steps are:</p>
<ol class="simple">
<li><p>Write a Python function that takes a Series and outputs a new Series.</p></li>
<li><p>Pass our new function as an argument to the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method (alternatively, the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method).</p></li>
</ol>
<p>As an example, we will standardize our unemployment data to have mean 0
and standard deviation 1.</p>
<p>After doing this, we can use an aggregation to determine at which date the
unemployment rate is most different from “normal times” for each state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 1: We write the Series transform function that we&#39;d like to use</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">standardize_data</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Changes the data in a Series to become mean 0 with standard deviation 1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">std</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Step 2: Apply our function via the apply method.</span>
<span class="c1">#</span>
<span class="n">std_unemp</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standardize_data</span><span class="p">)</span>
<span class="n">std_unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>-1.076861</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.337203</td>
      <td>-1.605740</td>
      <td>-0.925962</td>
      <td>-0.849345</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>-1.076861</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.337203</td>
      <td>-1.644039</td>
      <td>-0.925962</td>
      <td>-0.849345</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>-1.125778</td>
      <td>-0.935545</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.644039</td>
      <td>-0.991993</td>
      <td>-0.926885</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>-1.125778</td>
      <td>-0.894853</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.605740</td>
      <td>-0.991993</td>
      <td>-1.004424</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>-1.125778</td>
      <td>-0.894853</td>
      <td>-0.976846</td>
      <td>-1.286217</td>
      <td>-1.529141</td>
      <td>-0.991993</td>
      <td>-1.081964</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Takes the absolute value of all elements of a function</span>
<span class="n">abs_std_unemp</span> <span class="o">=</span> <span class="n">std_unemp</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

<span class="n">abs_std_unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>1.076861</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.337203</td>
      <td>1.605740</td>
      <td>0.925962</td>
      <td>0.849345</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>1.076861</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.337203</td>
      <td>1.644039</td>
      <td>0.925962</td>
      <td>0.849345</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>1.125778</td>
      <td>0.935545</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.644039</td>
      <td>0.991993</td>
      <td>0.926885</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>1.125778</td>
      <td>0.894853</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.605740</td>
      <td>0.991993</td>
      <td>1.004424</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>1.125778</td>
      <td>0.894853</td>
      <td>0.976846</td>
      <td>1.286217</td>
      <td>1.529141</td>
      <td>0.991993</td>
      <td>1.081964</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find the date when unemployment was &quot;most different from normal&quot; for each State</span>
<span class="k">def</span> <span class="nf">idxmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># idxmax of Series will return index of maximal value</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

<span class="n">abs_std_unemp</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">idxmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Arizona      2009-11-01
California   2010-03-01
Florida      2010-01-01
Illinois     2009-12-01
Michigan     2009-06-01
New York     2009-11-01
Texas        2009-08-01
dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="custom-scalar-transforms">
<h3><span class="section-number">6.2.5.3. </span>Custom Scalar Transforms<a class="headerlink" href="#custom-scalar-transforms" title="Permalink to this headline">¶</a></h3>
<p>As you may have predicted, we can also apply custom scalar transforms to our
pandas data.</p>
<p>To do this, we use the following pattern:</p>
<ol class="simple">
<li><p>Define a Python function that takes in a scalar and produces a scalar.</p></li>
<li><p>Pass this function as an argument to the <code class="docutils literal notranslate"><span class="pre">applymap</span></code> Series or DataFrame method.</p></li>
</ol>
<p>Complete the exercise below to practice writing and using your own scalar
transforms.</p>
<p><a id='exercise-2'></a></p>
<blockquote>
<div><p>See exercise 3 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
</div>
<div class="section" id="boolean-selection">
<h2><span class="section-number">6.2.6. </span>Boolean Selection<a class="headerlink" href="#boolean-selection" title="Permalink to this headline">¶</a></h2>
<p>We have seen how we can select subsets of data by referring to the index
or column names.</p>
<p>However, we often want to select based on conditions met by
the data itself.</p>
<p>Some examples are:</p>
<ul class="simple">
<li><p>Restrict analysis to all individuals older than 18.</p></li>
<li><p>Look at data that corresponds to particular time periods.</p></li>
<li><p>Analyze only data that corresponds to a recession.</p></li>
<li><p>Obtain data for a specific product or customer ID.</p></li>
</ul>
<p>We will be able to do this by using a Series or list of boolean values
to index into a Series or DataFrame.</p>
<p>Let’s look at some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1"># Create smaller data so we can see what&#39;s happening</span>
<span class="n">unemp_small</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list of booleans selects rows</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># second argument selects columns, the  ``:``  means &quot;all&quot;.</span>
<span class="c1"># here we use it to select all columns</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># can use booleans to select both rows and columns</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="creating-boolean-dataframes-series">
<h3><span class="section-number">6.2.6.1. </span>Creating Boolean DataFrames/Series<a class="headerlink" href="#creating-boolean-dataframes-series" title="Permalink to this headline">¶</a></h3>
<p>We can use <span class="xref myst">conditional statements</span> to
construct Series of booleans from our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01    False
2000-04-01     True
2000-05-01     True
Name: Texas, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>Once we have our Series of bools, we can use it to extract subsets of
rows from our DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    True
2000-02-01    True
2000-03-01    True
2000-04-01    True
2000-05-01    True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_NY</span> <span class="o">=</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">big_NY</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="multiple-conditions">
<h4><span class="section-number">6.2.6.1.1. </span>Multiple Conditions<a class="headerlink" href="#multiple-conditions" title="Permalink to this headline">¶</a></h4>
<p>In the boolean section of the <span class="xref myst">basics lecture</span>, we saw
that we can use the words <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> to combine multiple booleans into
a single bool.</p>
<p>Recall:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">and</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">and</span> <span class="pre">True</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span> <span class="pre">and</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">or</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span> <span class="pre">or</span> <span class="pre">True</span> <span class="pre">-&gt;</span> <span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span> <span class="pre">or</span> <span class="pre">False</span> <span class="pre">-&gt;</span> <span class="pre">False</span></code></p></li>
</ul>
<p>We can do something similar in pandas, but instead of
<code class="docutils literal notranslate"><span class="pre">bool1</span> <span class="pre">and</span> <span class="pre">bool2</span></code> we write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">bool_series1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bool_series2</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise, instead of <code class="docutils literal notranslate"><span class="pre">bool1</span> <span class="pre">or</span> <span class="pre">bool2</span></code> we write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">bool_series1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bool_series2</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_NYTX</span> <span class="o">=</span> <span class="p">(</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Texas&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">4.7</span><span class="p">)</span>
<span class="n">small_NYTX</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01     True
2000-04-01     True
2000-05-01     True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="n">small_NYTX</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.5</td>
      <td>4.6</td>
      <td>4.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="isin">
<h4><span class="section-number">6.2.6.1.2. </span><code class="docutils literal notranslate"><span class="pre">isin</span></code><a class="headerlink" href="#isin" title="Permalink to this headline">¶</a></h4>
<p>Sometimes, we will want to check whether a data point takes on one of a
several fixed values.</p>
<p>We could do this by writing <code class="docutils literal notranslate"><span class="pre">(df[&quot;x&quot;]</span> <span class="pre">==</span> <span class="pre">val_1)</span> <span class="pre">|</span> <span class="pre">(df[&quot;x&quot;]</span> <span class="pre">==</span> <span class="pre">val_2)</span></code>
(like we did above), but there is a better way: the <code class="docutils literal notranslate"><span class="pre">.isin</span></code> method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Michigan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01     True
2000-02-01     True
2000-03-01     True
2000-04-01     True
2000-05-01    False
Name: Michigan, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now select full rows where this Series is True</span>
<span class="n">unemp_small</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unemp_small</span><span class="p">[</span><span class="s2">&quot;Michigan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.3</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>4.1</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.2</td>
      <td>3.2</td>
      <td>4.7</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>4.0</td>
      <td>5.1</td>
      <td>3.7</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>4.6</td>
      <td>4.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="any-and-all">
<h4><span class="section-number">6.2.6.1.3. </span><code class="docutils literal notranslate"><span class="pre">.any</span></code> and <code class="docutils literal notranslate"><span class="pre">.all</span></code><a class="headerlink" href="#any-and-all" title="Permalink to this headline">¶</a></h4>
<p>Recall from the boolean section of the <span class="xref myst">basics lecture</span>
that the Python functions <code class="docutils literal notranslate"><span class="pre">any</span></code> and <code class="docutils literal notranslate"><span class="pre">all</span></code> are aggregation functions that
take a collection of booleans and return a single boolean.</p>
<p><code class="docutils literal notranslate"><span class="pre">any</span></code> returns True whenever at least one of the inputs are True while
<code class="docutils literal notranslate"><span class="pre">all</span></code> is True only when all the inputs are <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Series and DataFrames with <code class="docutils literal notranslate"><span class="pre">dtype</span></code> bool have <code class="docutils literal notranslate"><span class="pre">.any</span></code> and <code class="docutils literal notranslate"><span class="pre">.all</span></code>
methods that apply this logic to pandas objects.</p>
<p>Let’s use these methods to count how many months all the states in our
sample had high unemployment.</p>
<p>As we work through this example, consider the <a class="reference external" href="http://albertjmenkveld.com/2014/07/07/endogeneous-price-dispersion/">“want
operator”</a>, a helpful
concept from Nobel Laureate <a class="reference external" href="http://www.tomsargent.com">Tom
Sargent</a> for clearly stating the goal of our analysis and
determining the steps necessary to reach the goal.</p>
<p>We always begin by writing <code class="docutils literal notranslate"><span class="pre">Want:</span></code> followed by what we want to
accomplish.</p>
<p>In this case, we would write:</p>
<blockquote>
<div><p>Want: Count the number of months in which all states in our sample
had unemployment above 6.5%</p>
</div></blockquote>
<p>After identifying the <strong>want</strong>, we work <em>backwards</em> to identify the
steps necessary to accomplish our goal.</p>
<p>So, starting from the result, we have:</p>
<ol class="simple">
<li><p>Sum the number of <code class="docutils literal notranslate"><span class="pre">True</span></code> values in a Series indicating dates for
which all states had high unemployment.</p></li>
<li><p>Build the Series used in the last step by using the <code class="docutils literal notranslate"><span class="pre">.all</span></code> method
on a DataFrame containing booleans indicating whether each state had
high unemployment at each date.</p></li>
<li><p>Build the DataFrame used in the previous step using a <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>
comparison.</p></li>
</ol>
<p>Now that we have a clear plan, let’s follow through and <em>apply</em> the want
operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 3: construct the DataFrame of bools</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">unemp</span> <span class="o">&gt;</span> <span class="mf">6.5</span>
<span class="n">high</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Arizona</th>
      <th>California</th>
      <th>Florida</th>
      <th>Illinois</th>
      <th>Michigan</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-02-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-03-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-04-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2000-05-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 2: use the .all method on axis=1 to get the dates where all states have a True</span>
<span class="n">all_high</span> <span class="o">=</span> <span class="n">high</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_high</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2000-01-01    False
2000-02-01    False
2000-03-01    False
2000-04-01    False
2000-05-01    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Call .sum to add up the number of True values in `all_high`</span>
<span class="c1">#         (note that True == 1 and False == 0 in Python, so .sum will count Trues)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Out of </span><span class="si">{}</span><span class="s2"> months, </span><span class="si">{}</span><span class="s2"> had high unemployment across all states&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_high</span><span class="p">),</span> <span class="n">all_high</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Out of 216 months, 41 had high unemployment across all states
</pre></div>
</div>
</div>
</div>
<p><a id='exercise-3'></a></p>
<blockquote>
<div><p>See exercise 4 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">6.2.7. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p><a id='exerciselist-0'></a>
<strong>Exercise 1</strong></p>
<p>Looking at the displayed DataFrame above, can you identify the index? The columns?</p>
<p>You can use the cell below to verify your visual intuition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference external" href="#exercise-0"><em>back to text</em></a>)</p>
<p><strong>Exercise 2</strong></p>
<p>Do the following exercises in separate code cells below:</p>
<ul class="simple">
<li><p>At each date, what is the minimum unemployment rate across all states
in our sample?</p></li>
<li><p>What was the median unemployment rate in each state?</p></li>
<li><p>What was the maximum unemployment rate across the states in our
sample? What state did it happen in? In what month/year was this
achieved?</p>
<ul>
<li><p>Hint 1: What Python type (not <code class="docutils literal notranslate"><span class="pre">dtype</span></code>) is returned by the
aggregation?</p></li>
<li><p>Hint 2: Read documentation for the method <code class="docutils literal notranslate"><span class="pre">idxmax</span></code></p></li>
</ul>
</li>
<li><p>Classify each state as high or low volatility based on whether the
variance of their unemployment is above or below 4.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># min unemployment rate by state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># median unemployment rate by state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># max unemployment rate across all states and Year</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># low or high volatility</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference external" href="#exercise-1"><em>back to text</em></a>)</p>
<p><strong>Exercise 3</strong></p>
<p>Imagine that we want to determine whether unemployment was high (&gt; 6.5),
medium (4.5 &lt; x &lt;= 6.5), or low (&lt;= 4.5) for each state and each month.</p>
<ol class="simple">
<li><p>Write a Python function that takes a single number as an input and
outputs a single string noting if that number is high, medium, or low.</p></li>
<li><p>Pass your function to <code class="docutils literal notranslate"><span class="pre">applymap</span></code> (quiz: why <code class="docutils literal notranslate"><span class="pre">applymap</span></code> and not
<code class="docutils literal notranslate"><span class="pre">agg</span></code> or <code class="docutils literal notranslate"><span class="pre">apply</span></code>?) and save the result in a new DataFrame called
<code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code>.</p></li>
<li><p>(Challenging) This exercise has multiple parts:</p></li>
<li><p>Use another transform on <code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code> to count how many
times each state had each of the three classifications.<br />
- Hint 1: Will this value counting function be a Series or scalar
transform?<br />
- Hint 2: Try googling “pandas count unique value” or something
similar to find the right transform.</p></li>
<li><p>Construct a horizontal bar chart of the number of occurrences of
each level with one bar per state and classification (21 total
bars).</p></li>
<li><p>(Challenging) Repeat the previous step, but count how many states had
each classification in each month. Which month had the most states
with high unemployment? What about medium and low?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 1: Write a Python function to classify unemployment levels.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 2: Pass your function from part 1 to applymap</span>
<span class="n">unemp_bins</span> <span class="o">=</span> <span class="n">unemp</span><span class="o">.</span><span class="n">applymap</span><span class="c1">#replace this comment with your code!!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 3: Count the number of times each state had each classification.</span>

<span class="c1">## then make a horizontal bar chart here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 4: Apply the same transform from part 4, but to each date instead of to each state.</span>
</pre></div>
</div>
</div>
</div>
<p>(<a class="reference external" href="#exercise-2"><em>back to text</em></a>)</p>
<p><strong>Exercise 4</strong></p>
<ul class="simple">
<li><p>For a single state of your choice, determine what the mean
unemployment is during “Low”, “Medium”, and “High” unemployment times
(recall your <code class="docutils literal notranslate"><span class="pre">unemp_bins</span></code> DataFrame from the exercise above).</p>
<ul>
<li><p>Think about how you would do this for all the
states in our sample and write your thoughts… We will soon
learn tools that will <em>greatly</em> simplify operations like
this that operate on distinct <em>groups</em> of data at a time.</p></li>
</ul>
</li>
<li><p>Which states in our sample performs the best during “bad times?” To
determine this, compute the mean unemployment for each state only for
months in which the mean unemployment rate in our sample is greater
than 7.</p></li>
</ul>
<p>(<a class="reference external" href="#exercise-3"><em>back to text</em></a>)</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page"><span class="section-number">6.1. </span>Introduction</a>
    <a class='right-next' id="next-link" href="the_index.html" title="next page"><span class="section-number">6.3. </span>The Index</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alan Moreira<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>