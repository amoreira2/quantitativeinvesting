
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.8. Time series &#8212; Quantitative Investing</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/book.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://amoreira2.github.io/quantitativeinvesting/chapters/pandas/timeseries.html" />
    <link rel="shortcut icon" href="../../_static/figuremain2.jpg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.9. Intermediate Plotting (opt)" href="matplotlib.html" />
    <link rel="prev" title="6.7. GroupBy (opt)" href="groupby.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/figuremain2.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Quantitative Investing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/what-is-quant-investing.html">
   1. What is Quantitative Investing?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/statistical-techniques.html">
     1.1. Statistical Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/computational-tools.html">
     1.2. Computational tools
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/getting_started.html">
   2. Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/local_install.html">
     2.3. Local installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/cloud_setup.html">
     2.4. Cloud Setup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/programming-in-python.html">
   3. First Steps with Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/1/Expressions.html">
     3.1. Expressions
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/2/Names.html">
     3.2. Names
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/2/1/Growth.html">
       3.2.1. Example: Growth Rates
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/3/Calls.html">
     3.3. Call Expressions
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/4/Data_Types.html">
     3.4. Data Types
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/4/1/Numbers.html">
       3.4.1. Numbers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/4/2/Strings.html">
       3.4.2. Strings
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../03/5/Sequences.html">
     3.5. Sequences
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/1/Arrays.html">
       3.5.1. Arrays
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/2/Ranges.html">
       3.5.2. Ranges
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../03/5/3/More_on_Arrays.html">
       3.5.3. More on Arrays
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../essentials/essentials.html">
   4. Python Essentials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/basics.html">
     4.1. Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/collections.html">
     4.2. Collections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/control_flow.html">
     4.3. Flow control
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../essentials/functions.html">
     4.4. Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../scientific/intro.html">
   5. Scientific Computing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/numpy1.html">
     5.1. Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/plotting1.html">
     5.2. Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/linear_algebra1.html">
     5.3. Linear algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/randomness1.html">
     5.4. Randomness
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="workingwithdata.html">
   6. Working with Data
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro.html">
     6.1. Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basics.html">
     6.2. Pandas Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="the_index.html">
     6.3. Indexing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data_clean.html">
     6.4. Cleaning data (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="reshape.html">
     6.5. Reshape (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="merge.html">
     6.6. Merge (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="groupby.html">
     6.7. Group-by (opt)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.8. Time-Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="matplotlib.html">
     6.9. Plotting (opt)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="storage_formats.html">
     6.10. Data Storage (opt)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Returns.html">
   7. Asset Returns
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/TheChoiceofFrequency.html">
     7.1. The Choice of Frequency and Annualization of Returns
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/PortfolioMath.html">
   8. Portfolio Math
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/CapitalAllocationLine.html">
   9. Capital Allocation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/UsingAPI.html">
     9.1. Using APIs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/MeanVariance.html">
   10. Mean Variance Efficient Portfolios
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/CaseStudy.html">
     10.1. Case Study in International Diversification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/LeverageandShorting.html">
     10.2. Leverage and Shorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Portfoliooptimizationwithconstraints.html">
     10.3. Portfolio Optimization with constraints
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/EstimationUncertainty.html">
   11. Estimation Uncertainty and It's Implications for investing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Finance/TradingStrategies.html">
   12. Trading Strategies
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Timing.html">
   13. Timing Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Volatilitytiming.html">
     13.1. Volatility Timing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/crosssectionalequitystrategies.html">
   14. Cross-Sectional Equity Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Valueinvesting.html">
     14.1. Value
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Momentum.html">
     14.2. Momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/OtherEquityStrategies.html">
     14.3. Other Equity strategies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Evaluation.html">
   15. Evaluating a Trading Strategy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Econometrics.html">
     15.1. The Econometrics of Strategy Evalaution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/outofsample.html">
     15.2. Out of Sample Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/TailandBackground.html">
     15.3. Tail Risks and Background Risks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/MultiFactorModels.html">
     15.4. Multifactor Models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Finance/Topics.html">
   16. Topics in Quantitative Investing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Equilbrium.html">
     16.1. Intepreting Factor models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Implementation.html">
     16.2. Strategy Implementation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Finance/Horizon.html">
     16.3. Investment horizon effects
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../additional/additional.html">
   17. Additional Statistics Material
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/10/Sampling_and_Empirical_Distributions.html">
     17.2. Sampling and Empirical Distributions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/1/Empirical_Distributions.html">
       17.2.1. Empirical Distributions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/2/Sampling_from_a_Population.html">
       17.2.2. Sampling from a Population
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/10/3/Empirical_Distribution_of_a_Statistic.html">
       17.2.3. Empirical Distibution of a Statistic
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/11/Testing_Hypotheses.html">
     17.3. Testing Hypotheses
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/1/Assessing_Models.html">
       17.3.1. Assessing Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/2/Multiple_Categories.html">
       17.3.2. Multiple Categories
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/3/Decisions_and_Uncertainty.html">
       17.3.3. Decisions and Uncertainty
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/11/4/Error_Probabilities.html">
       17.3.4. Error Probabilities
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/13/Estimation.html">
     17.4. Estimation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
    <label for="toctree-checkbox-20">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/1/Percentiles.html">
       17.4.1. Percentiles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/2/Bootstrap.html">
       17.4.2. The Bootstrap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/3/Confidence_Intervals.html">
       17.4.3. Confidence Intervals
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/13/4/Using_Confidence_Intervals.html">
       17.4.4. Using Confidence Intervals
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/14/Why_the_Mean_Matters.html">
     17.5. Why the Mean Matters
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
    <label for="toctree-checkbox-21">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/1/Properties_of_the_Mean.html">
       17.5.1. Properties of the Mean
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/2/Variability.html">
       17.5.2. Variability
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/3/SD_and_the_Normal_Curve.html">
       17.5.3. The SD and the Normal Curve
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/4/Central_Limit_Theorem.html">
       17.5.4. The Central Limit Theorem
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/5/Variability_of_the_Sample_Mean.html">
       17.5.5. The Variability of the Sample Mean
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/14/6/Choosing_a_Sample_Size.html">
       17.5.6. Choosing a Sample Size
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/15/Prediction.html">
     17.6. Prediction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
    <label for="toctree-checkbox-22">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/1/Correlation.html">
       17.6.1. Correlation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/2/Regression_Line.html">
       17.6.2. The Regression Line
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/3/Method_of_Least_Squares.html">
       17.6.3. The Method of Least Squares
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/4/Least_Squares_Regression.html">
       17.6.4. Least Squares Regression
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/5/Visual_Diagnostics.html">
       17.6.5. Visual Diagnostics
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/15/6/Numerical_Diagnostics.html">
       17.6.6. Numerical Diagnostics
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../additional/16/Inference_for_Regression.html">
     17.7. Inference for Regression
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/1/Regression_Model.html">
       17.7.1. A Regression Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/2/Inference_for_the_True_Slope.html">
       17.7.2. Inference for the True Slope
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../additional/16/3/Prediction_Intervals.html">
       17.7.3. Prediction Intervals
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/pandas/timeseries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/amoreira2/Lectures"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/amoreira2/Lectures/issues/new?title=Issue%20on%20page%20%2Fchapters/pandas/timeseries.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/amoreira2/Lectures/main?urlpath=lab/tree/chapters/pandas/timeseries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://pims.syzygy.ca/jupyter/hub/user-redirect/git-pull?repo=https://github.com/amoreira2/Lectures&urlpath=lab/tree/Lectures/chapters/pandas/timeseries.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/amoreira2/Lectures/blob/main/chapters/pandas/timeseries.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outline">
   6.8.1. Outline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#intro">
   6.8.2. Intro
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parsing-strings-as-dates">
   6.8.3. Parsing Strings as Dates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiple-dates">
     6.8.3.1. Multiple Dates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#date-formatting">
   6.8.4. Date Formatting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extracting-data">
   6.8.5. Extracting Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accessing-date-properties">
   6.8.6. Accessing Date Properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#leads-and-lags-df-shift">
   6.8.7. Leads and Lags:
   <code class="docutils literal notranslate">
    <span class="pre">
     df.shift
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rolling-computations-rolling">
   6.8.8. Rolling Computations:
   <code class="docutils literal notranslate">
    <span class="pre">
     .rolling
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#changing-frequencies-resample-opt">
   6.8.9. Changing Frequencies:
   <code class="docutils literal notranslate">
    <span class="pre">
     .resample
    </span>
   </code>
   (Opt)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="time-series">
<h1><span class="section-number">6.8. </span>Time series<a class="headerlink" href="#time-series" title="Permalink to this headline">¶</a></h1>
<p><strong>Prerequisites</strong></p>
<ul class="simple">
<li><p><span class="xref myst">Python functions</span></p></li>
<li><p><a class="reference internal" href="groupby.html"><span class="doc std std-doc">GroupBy</span></a></p></li>
</ul>
<p><strong>Outcomes</strong></p>
<ul class="simple">
<li><p>Know how pandas handles dates</p></li>
<li><p>Understand how to parse strings into <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects</p></li>
<li><p>Know how to write dates as custom formatted strings</p></li>
<li><p>Be able to access day, month, year, etc. for a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> and
a column with <code class="docutils literal notranslate"><span class="pre">dtype</span></code> <code class="docutils literal notranslate"><span class="pre">datetime</span></code></p></li>
<li><p>Understand both rolling and re-sampling operations and the difference
between the two</p></li>
</ul>
<p><strong>Data</strong></p>
<ul class="simple">
<li><p>Bitcoin to USD exchange rates from March 2014 to the present</p></li>
</ul>
<div class="section" id="outline">
<h2><span class="section-number">6.8.1. </span>Outline<a class="headerlink" href="#outline" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Time-series">Time series</a></p>
<ul>
<li><p><a class="reference external" href="#Intro">Intro</a></p></li>
<li><p><a class="reference external" href="#Parsing-Strings-as-Dates">Parsing Strings as Dates</a></p></li>
<li><p><a class="reference external" href="#Date-Formatting">Date Formatting</a></p></li>
<li><p><a class="reference external" href="#Extracting-Data">Extracting Data</a></p></li>
<li><p><a class="reference external" href="#Accessing-Date-Properties">Accessing Date Properties</a></p></li>
<li><p><a class="reference external" href="#Leads-and-Lags:-%60df.shift%60">Leads and Lags: <code class="docutils literal notranslate"><span class="pre">df.shift</span></code></a></p></li>
<li><p><a class="reference external" href="#Rolling-Computations:-%60.rolling%60">Rolling Computations: <code class="docutils literal notranslate"><span class="pre">.rolling</span></code></a></p></li>
<li><p><a class="reference external" href="#Changing-Frequencies:-%60.resample%60">Changing Frequencies: <code class="docutils literal notranslate"><span class="pre">.resample</span></code></a></p></li>
<li><p><a class="reference external" href="#Optional:-API-keys">Optional: API keys</a></p></li>
<li><p><a class="reference external" href="#Exercises">Exercises</a></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment following line to install on colab</span>
<span class="c1">#! pip install qeds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">wallstreet</span> <span class="kn">import</span> <span class="n">Stock</span>
<span class="kn">import</span> <span class="nn">qeds</span>

<span class="c1"># see section on API keys at end of lecture!</span>
<span class="n">quandl</span><span class="o">.</span><span class="n">ApiConfig</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;QUANDL_AUTH&quot;</span><span class="p">,</span> <span class="s2">&quot;Dn6BtVoBhzuKTuyo6hbp&quot;</span><span class="p">)</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;2014-05-01&quot;</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># activate plot theme</span>
<span class="kn">import</span> <span class="nn">qeds</span>
<span class="n">qeds</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">mpl_style</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="intro">
<h2><span class="section-number">6.8.2. </span>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h2>
<p>pandas has extensive support for handling dates and times.</p>
<p>We will loosely refer to data with date or time information as time
series data.</p>
<p>In this lecture, we will cover the most useful parts of pandas’ time
series functionality.</p>
<p>Among these topics are:</p>
<ul class="simple">
<li><p>Parsing strings as dates</p></li>
<li><p>Writing <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects as (inverse operation of previous point)</p></li>
<li><p>Extracting data from a DataFrame or Series with date information in
the index</p></li>
<li><p>Shifting data through time (taking leads or lags)</p></li>
<li><p>Re-sampling data to a different frequency and rolling operations</p></li>
</ul>
<p>However, even more than with previous topics, we will skip a lot of the
functionality pandas offers, and we urge you to refer to the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/timeseries.html">official
documentation</a>
for more information.</p>
</div>
<div class="section" id="parsing-strings-as-dates">
<h2><span class="section-number">6.8.3. </span>Parsing Strings as Dates<a class="headerlink" href="#parsing-strings-as-dates" title="Permalink to this headline">¶</a></h2>
<p>When working with time series data, we almost always receive the data
with dates encoded as strings.</p>
<p>Hopefully, the date strings follow a structured format or pattern.</p>
<p>One common pattern is <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD</span></code>: 4 numbers for the year, 2 for the
month, and 2 for the day with each section separated by a <code class="docutils literal notranslate"><span class="pre">-</span></code>.</p>
<p>For example, we write Christmas day 2017 in this format as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas_str</span> <span class="o">=</span> <span class="s2">&quot;2017-12-25&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>To convert a string into a time-aware object, we use the
<code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_str</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The type of christmas is&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">christmas</span><span class="p">))</span>
<span class="n">christmas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The type of christmas is &lt;class &#39;pandas._libs.tslibs.timestamps.Timestamp&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2017-12-25 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function is pretty smart at guessing the format
of the date…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;December 25, 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;Dec. 25, 2017&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Monday, Dec. 25, 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;25 Dec. 2017&quot;</span><span class="p">,</span> <span class="s2">&quot;25th Dec. 2017&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pandas interprets </span><span class="si">{}</span><span class="s2"> as </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas interprets December 25, 2017 as 2017-12-25 00:00:00
pandas interprets Dec. 25, 2017 as 2017-12-25 00:00:00
pandas interprets Monday, Dec. 25, 2017 as 2017-12-25 00:00:00
pandas interprets 25 Dec. 2017 as 2017-12-25 00:00:00
pandas interprets 25th Dec. 2017 as 2017-12-25 00:00:00
</pre></div>
</div>
</div>
</div>
<p>However, sometimes we will need to give pandas a hint.</p>
<p>For example, that same time (midnight on Christmas) would be reported on
an Amazon transaction report as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas_amzn</span> <span class="o">=</span> <span class="s2">&quot;2017-12-25T00:00:00+ 00 :00&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>If we try to pass this to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>, it will fail.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">)</span>
</pre></div>
</div>
<p>To parse a date with this format, we need to specify the <code class="docutils literal notranslate"><span class="pre">format</span></code>
argument for <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">amzn_strftime</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S+ 00 :00&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">amzn_strftime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2017-12-25 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<p>Can you guess what <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> represents?</p>
<p>Let’s take a closer look at <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> and <code class="docutils literal notranslate"><span class="pre">christmas_amzn</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">amzn_strftime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">christmas_amzn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>%Y-%m-%dT%H:%M:%S+ 00 :00
2017-12-25T00:00:00+ 00 :00
</pre></div>
</div>
</div>
</div>
<p>Notice that both of the strings have a similar form, but that instead of actual numerical values, <code class="docutils literal notranslate"><span class="pre">amzn_strftime</span></code> has <em>placeholders</em>.</p>
<p>Specifically, anywhere the <code class="docutils literal notranslate"><span class="pre">%</span></code> shows up is a signal to the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>
function that it is where relevant information is stored.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">%Y</span></code> is a stand-in for a four digit year, <code class="docutils literal notranslate"><span class="pre">%m</span></code> is
for 2 a digit month, and so on…</p>
<p>The official <a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">Python
documentation</a> contains a complete list of possible <code class="docutils literal notranslate"><span class="pre">%</span></code>something patterns that are accepted
in the <code class="docutils literal notranslate"><span class="pre">format</span></code> argument.</p>
<p><a id='exercise-0'></a></p>
<blockquote>
<div><p>See exercise 1 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
<div class="section" id="multiple-dates">
<h3><span class="section-number">6.8.3.1. </span>Multiple Dates<a class="headerlink" href="#multiple-dates" title="Permalink to this headline">¶</a></h3>
<p>If we have dates in a Series (e.g. column of DataFrame) or a list, we
can pass the entire collection to <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> and get a
collection of dates back.</p>
<p>We’ll just show an example of that here as the mechanics are the same as
a single date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2017-12-25&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2017-12-25&#39;, &#39;2017-12-31&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="date-formatting">
<h2><span class="section-number">6.8.4. </span>Date Formatting<a class="headerlink" href="#date-formatting" title="Permalink to this headline">¶</a></h2>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">%</span></code>pattern format to have pandas write <code class="docutils literal notranslate"><span class="pre">datetime</span></code>
objects as specially formatted strings using the <code class="docutils literal notranslate"><span class="pre">strftime</span></code> (string
format time) method.</p>
<p>For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">christmas</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;We love %A %B </span><span class="si">%d</span><span class="s2"> (also written </span><span class="si">%c</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;We love Monday December 25 (also written Mon Dec 25 00:00:00 2017)&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extracting-data">
<h2><span class="section-number">6.8.5. </span>Extracting Data<a class="headerlink" href="#extracting-data" title="Permalink to this headline">¶</a></h2>
<p>When the index of a DataFrame has date information and pandas
recognizes the values as <code class="docutils literal notranslate"><span class="pre">datetime</span></code> values, we can leverage some
convenient indexing features for extracting data.</p>
<p>The flexibility of these features is best understood through example,
so let’s load up some data and take a look.</p>
<hr class="docutils" />
<p>Below we are using Quandl an API that allows us to get a wide range of data for free <a class="reference external" href="https://www.quandl.com/search?filters=%5B%22Free%22%5D&amp;page=3">here is a list of free data sets</a></p>
<p>There is a wide range of different API for Python. We will later discuss a few more that we will use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Stock</span><span class="p">(</span><span class="s1">&#39;GME&#39;</span><span class="p">)</span>

<span class="n">gme</span><span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">historical</span><span class="p">(</span><span class="n">days_back</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">gme</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gme</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">gme</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 2071 entries, 2013-02-25 to 2021-05-14
Data columns (total 6 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Open       2071 non-null   float64
 1   High       2071 non-null   float64
 2   Low        2071 non-null   float64
 3   Close      2071 non-null   float64
 4   Adj Close  2071 non-null   float64
 5   Volume     2071 non-null   int64  
dtypes: float64(5), int64(1)
memory usage: 113.3 KB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>24.770000</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>24.639999</td>
      <td>24.850000</td>
      <td>23.950001</td>
      <td>24.049999</td>
      <td>16.991102</td>
      <td>3525900</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here, we have the Bitcoin (BTC) to US dollar (USD) exchange rate from
March 2014 until today.</p>
<p>Notice that the type of index is <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code>.</p>
<p>This is the key that enables things like…</p>
<p>Extracting all data for the year 2015 by passing <code class="docutils literal notranslate"><span class="pre">&quot;2015&quot;</span></code> to <code class="docutils literal notranslate"><span class="pre">.loc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2015&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-02</th>
      <td>34.060001</td>
      <td>34.160000</td>
      <td>33.250000</td>
      <td>33.799999</td>
      <td>25.155836</td>
      <td>1612700</td>
    </tr>
    <tr>
      <th>2015-01-05</th>
      <td>33.520000</td>
      <td>34.880001</td>
      <td>33.330002</td>
      <td>34.720001</td>
      <td>25.840551</td>
      <td>4934900</td>
    </tr>
    <tr>
      <th>2015-01-06</th>
      <td>35.169998</td>
      <td>36.029999</td>
      <td>33.520000</td>
      <td>33.689999</td>
      <td>25.073961</td>
      <td>4885100</td>
    </tr>
    <tr>
      <th>2015-01-07</th>
      <td>34.290001</td>
      <td>34.680000</td>
      <td>32.980000</td>
      <td>33.299999</td>
      <td>24.783703</td>
      <td>2558300</td>
    </tr>
    <tr>
      <th>2015-01-08</th>
      <td>33.599998</td>
      <td>34.169998</td>
      <td>33.320000</td>
      <td>33.689999</td>
      <td>25.073961</td>
      <td>4547400</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2015-12-24</th>
      <td>28.620001</td>
      <td>28.799999</td>
      <td>28.280001</td>
      <td>28.370001</td>
      <td>21.895107</td>
      <td>869000</td>
    </tr>
    <tr>
      <th>2015-12-28</th>
      <td>28.370001</td>
      <td>28.940001</td>
      <td>28.139999</td>
      <td>28.469999</td>
      <td>21.972286</td>
      <td>2325400</td>
    </tr>
    <tr>
      <th>2015-12-29</th>
      <td>28.620001</td>
      <td>28.799999</td>
      <td>28.330000</td>
      <td>28.430000</td>
      <td>21.941414</td>
      <td>2040400</td>
    </tr>
    <tr>
      <th>2015-12-30</th>
      <td>28.370001</td>
      <td>28.940001</td>
      <td>28.240000</td>
      <td>28.480000</td>
      <td>21.980001</td>
      <td>1438300</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>28.430000</td>
      <td>28.860001</td>
      <td>28.030001</td>
      <td>28.040001</td>
      <td>21.640425</td>
      <td>1696000</td>
    </tr>
  </tbody>
</table>
<p>252 rows × 6 columns</p>
</div></div></div>
</div>
<p>We can also narrow down to specific months.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By month&#39;s name</span>
<span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;August 2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-08-01</th>
      <td>21.690001</td>
      <td>21.690001</td>
      <td>21.139999</td>
      <td>21.360001</td>
      <td>17.939491</td>
      <td>3059100</td>
    </tr>
    <tr>
      <th>2017-08-02</th>
      <td>21.320000</td>
      <td>21.620001</td>
      <td>21.270000</td>
      <td>21.379999</td>
      <td>17.956287</td>
      <td>1116100</td>
    </tr>
    <tr>
      <th>2017-08-03</th>
      <td>21.320000</td>
      <td>21.820000</td>
      <td>21.320000</td>
      <td>21.660000</td>
      <td>18.191450</td>
      <td>1047900</td>
    </tr>
    <tr>
      <th>2017-08-04</th>
      <td>21.780001</td>
      <td>22.110001</td>
      <td>21.690001</td>
      <td>21.930000</td>
      <td>18.418217</td>
      <td>1136100</td>
    </tr>
    <tr>
      <th>2017-08-07</th>
      <td>21.940001</td>
      <td>22.260000</td>
      <td>21.830000</td>
      <td>22.170000</td>
      <td>18.619781</td>
      <td>1277600</td>
    </tr>
    <tr>
      <th>2017-08-08</th>
      <td>22.200001</td>
      <td>22.370001</td>
      <td>21.900000</td>
      <td>21.940001</td>
      <td>18.426615</td>
      <td>1422500</td>
    </tr>
    <tr>
      <th>2017-08-09</th>
      <td>21.750000</td>
      <td>22.120001</td>
      <td>21.620001</td>
      <td>22.080000</td>
      <td>18.544193</td>
      <td>1503500</td>
    </tr>
    <tr>
      <th>2017-08-10</th>
      <td>21.910000</td>
      <td>21.910000</td>
      <td>21.459999</td>
      <td>21.469999</td>
      <td>18.031876</td>
      <td>1521300</td>
    </tr>
    <tr>
      <th>2017-08-11</th>
      <td>21.240000</td>
      <td>21.830000</td>
      <td>21.070000</td>
      <td>21.760000</td>
      <td>18.275438</td>
      <td>1619300</td>
    </tr>
    <tr>
      <th>2017-08-14</th>
      <td>21.950001</td>
      <td>21.990000</td>
      <td>21.719999</td>
      <td>21.850000</td>
      <td>18.351025</td>
      <td>1533900</td>
    </tr>
    <tr>
      <th>2017-08-15</th>
      <td>21.700001</td>
      <td>21.770000</td>
      <td>20.780001</td>
      <td>20.930000</td>
      <td>17.578348</td>
      <td>3888400</td>
    </tr>
    <tr>
      <th>2017-08-16</th>
      <td>21.120001</td>
      <td>21.490000</td>
      <td>21.080000</td>
      <td>21.389999</td>
      <td>17.964685</td>
      <td>2439400</td>
    </tr>
    <tr>
      <th>2017-08-17</th>
      <td>21.370001</td>
      <td>21.660000</td>
      <td>21.000000</td>
      <td>21.100000</td>
      <td>17.721127</td>
      <td>1939600</td>
    </tr>
    <tr>
      <th>2017-08-18</th>
      <td>21.049999</td>
      <td>21.330000</td>
      <td>20.969999</td>
      <td>21.219999</td>
      <td>17.821911</td>
      <td>2123500</td>
    </tr>
    <tr>
      <th>2017-08-21</th>
      <td>21.160000</td>
      <td>21.360001</td>
      <td>20.969999</td>
      <td>20.980000</td>
      <td>17.620342</td>
      <td>1633100</td>
    </tr>
    <tr>
      <th>2017-08-22</th>
      <td>21.120001</td>
      <td>21.690001</td>
      <td>21.090000</td>
      <td>21.639999</td>
      <td>18.174654</td>
      <td>2473800</td>
    </tr>
    <tr>
      <th>2017-08-23</th>
      <td>21.590000</td>
      <td>21.820000</td>
      <td>21.209999</td>
      <td>21.480000</td>
      <td>18.040277</td>
      <td>2432900</td>
    </tr>
    <tr>
      <th>2017-08-24</th>
      <td>21.750000</td>
      <td>22.120001</td>
      <td>21.650000</td>
      <td>21.780001</td>
      <td>18.292234</td>
      <td>4234600</td>
    </tr>
    <tr>
      <th>2017-08-25</th>
      <td>19.900000</td>
      <td>19.940001</td>
      <td>18.719999</td>
      <td>19.400000</td>
      <td>16.293360</td>
      <td>20500700</td>
    </tr>
    <tr>
      <th>2017-08-28</th>
      <td>19.410000</td>
      <td>19.700001</td>
      <td>18.959999</td>
      <td>19.150000</td>
      <td>16.083393</td>
      <td>5228400</td>
    </tr>
    <tr>
      <th>2017-08-29</th>
      <td>18.930000</td>
      <td>19.070000</td>
      <td>18.639999</td>
      <td>18.750000</td>
      <td>15.747450</td>
      <td>4667700</td>
    </tr>
    <tr>
      <th>2017-08-30</th>
      <td>18.750000</td>
      <td>18.969999</td>
      <td>18.680000</td>
      <td>18.790001</td>
      <td>15.781042</td>
      <td>2210100</td>
    </tr>
    <tr>
      <th>2017-08-31</th>
      <td>18.830000</td>
      <td>18.870001</td>
      <td>18.469999</td>
      <td>18.500000</td>
      <td>15.537482</td>
      <td>2629600</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By month&#39;s number</span>
<span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;08/2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-08-01</th>
      <td>21.690001</td>
      <td>21.690001</td>
      <td>21.139999</td>
      <td>21.360001</td>
      <td>17.939491</td>
      <td>3059100</td>
    </tr>
    <tr>
      <th>2017-08-02</th>
      <td>21.320000</td>
      <td>21.620001</td>
      <td>21.270000</td>
      <td>21.379999</td>
      <td>17.956287</td>
      <td>1116100</td>
    </tr>
    <tr>
      <th>2017-08-03</th>
      <td>21.320000</td>
      <td>21.820000</td>
      <td>21.320000</td>
      <td>21.660000</td>
      <td>18.191450</td>
      <td>1047900</td>
    </tr>
    <tr>
      <th>2017-08-04</th>
      <td>21.780001</td>
      <td>22.110001</td>
      <td>21.690001</td>
      <td>21.930000</td>
      <td>18.418217</td>
      <td>1136100</td>
    </tr>
    <tr>
      <th>2017-08-07</th>
      <td>21.940001</td>
      <td>22.260000</td>
      <td>21.830000</td>
      <td>22.170000</td>
      <td>18.619781</td>
      <td>1277600</td>
    </tr>
    <tr>
      <th>2017-08-08</th>
      <td>22.200001</td>
      <td>22.370001</td>
      <td>21.900000</td>
      <td>21.940001</td>
      <td>18.426615</td>
      <td>1422500</td>
    </tr>
    <tr>
      <th>2017-08-09</th>
      <td>21.750000</td>
      <td>22.120001</td>
      <td>21.620001</td>
      <td>22.080000</td>
      <td>18.544193</td>
      <td>1503500</td>
    </tr>
    <tr>
      <th>2017-08-10</th>
      <td>21.910000</td>
      <td>21.910000</td>
      <td>21.459999</td>
      <td>21.469999</td>
      <td>18.031876</td>
      <td>1521300</td>
    </tr>
    <tr>
      <th>2017-08-11</th>
      <td>21.240000</td>
      <td>21.830000</td>
      <td>21.070000</td>
      <td>21.760000</td>
      <td>18.275438</td>
      <td>1619300</td>
    </tr>
    <tr>
      <th>2017-08-14</th>
      <td>21.950001</td>
      <td>21.990000</td>
      <td>21.719999</td>
      <td>21.850000</td>
      <td>18.351025</td>
      <td>1533900</td>
    </tr>
    <tr>
      <th>2017-08-15</th>
      <td>21.700001</td>
      <td>21.770000</td>
      <td>20.780001</td>
      <td>20.930000</td>
      <td>17.578348</td>
      <td>3888400</td>
    </tr>
    <tr>
      <th>2017-08-16</th>
      <td>21.120001</td>
      <td>21.490000</td>
      <td>21.080000</td>
      <td>21.389999</td>
      <td>17.964685</td>
      <td>2439400</td>
    </tr>
    <tr>
      <th>2017-08-17</th>
      <td>21.370001</td>
      <td>21.660000</td>
      <td>21.000000</td>
      <td>21.100000</td>
      <td>17.721127</td>
      <td>1939600</td>
    </tr>
    <tr>
      <th>2017-08-18</th>
      <td>21.049999</td>
      <td>21.330000</td>
      <td>20.969999</td>
      <td>21.219999</td>
      <td>17.821911</td>
      <td>2123500</td>
    </tr>
    <tr>
      <th>2017-08-21</th>
      <td>21.160000</td>
      <td>21.360001</td>
      <td>20.969999</td>
      <td>20.980000</td>
      <td>17.620342</td>
      <td>1633100</td>
    </tr>
    <tr>
      <th>2017-08-22</th>
      <td>21.120001</td>
      <td>21.690001</td>
      <td>21.090000</td>
      <td>21.639999</td>
      <td>18.174654</td>
      <td>2473800</td>
    </tr>
    <tr>
      <th>2017-08-23</th>
      <td>21.590000</td>
      <td>21.820000</td>
      <td>21.209999</td>
      <td>21.480000</td>
      <td>18.040277</td>
      <td>2432900</td>
    </tr>
    <tr>
      <th>2017-08-24</th>
      <td>21.750000</td>
      <td>22.120001</td>
      <td>21.650000</td>
      <td>21.780001</td>
      <td>18.292234</td>
      <td>4234600</td>
    </tr>
    <tr>
      <th>2017-08-25</th>
      <td>19.900000</td>
      <td>19.940001</td>
      <td>18.719999</td>
      <td>19.400000</td>
      <td>16.293360</td>
      <td>20500700</td>
    </tr>
    <tr>
      <th>2017-08-28</th>
      <td>19.410000</td>
      <td>19.700001</td>
      <td>18.959999</td>
      <td>19.150000</td>
      <td>16.083393</td>
      <td>5228400</td>
    </tr>
    <tr>
      <th>2017-08-29</th>
      <td>18.930000</td>
      <td>19.070000</td>
      <td>18.639999</td>
      <td>18.750000</td>
      <td>15.747450</td>
      <td>4667700</td>
    </tr>
    <tr>
      <th>2017-08-30</th>
      <td>18.750000</td>
      <td>18.969999</td>
      <td>18.680000</td>
      <td>18.790001</td>
      <td>15.781042</td>
      <td>2210100</td>
    </tr>
    <tr>
      <th>2017-08-31</th>
      <td>18.830000</td>
      <td>18.870001</td>
      <td>18.469999</td>
      <td>18.500000</td>
      <td>15.537482</td>
      <td>2629600</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Or even a day…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By date name</span>
<span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;August 1, 2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Open         2.169000e+01
High         2.169000e+01
Low          2.114000e+01
Close        2.136000e+01
Adj Close    1.793949e+01
Volume       3.059100e+06
Name: 2017-08-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># By date number</span>
<span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;08-01-2017&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Open         2.169000e+01
High         2.169000e+01
Low          2.114000e+01
Close        2.136000e+01
Adj Close    1.793949e+01
Volume       3.059100e+06
Name: 2017-08-01 00:00:00, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>What can we pass as the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> argument when we have a
<code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code>?</p>
<p>Anything that can be converted to a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> using
<code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code>, <em>without</em> having to specify the format argument.</p>
<p>When that condition holds, pandas will return <em>all</em> rows whose date in
the index “belong” to that date or period.</p>
<p>We can also use the range shorthand notation to give a start and end
date for selection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;April 1, 2015&quot;</span><span class="p">:</span><span class="s2">&quot;April 10, 2015&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-04-01</th>
      <td>37.860001</td>
      <td>38.500000</td>
      <td>37.330002</td>
      <td>37.779999</td>
      <td>28.375410</td>
      <td>2464900</td>
    </tr>
    <tr>
      <th>2015-04-02</th>
      <td>38.060001</td>
      <td>38.810001</td>
      <td>37.880001</td>
      <td>38.200001</td>
      <td>28.690855</td>
      <td>1172600</td>
    </tr>
    <tr>
      <th>2015-04-06</th>
      <td>38.000000</td>
      <td>38.389999</td>
      <td>37.680000</td>
      <td>38.369999</td>
      <td>28.818537</td>
      <td>1483900</td>
    </tr>
    <tr>
      <th>2015-04-07</th>
      <td>38.369999</td>
      <td>38.500000</td>
      <td>37.919998</td>
      <td>37.980000</td>
      <td>28.525623</td>
      <td>1332100</td>
    </tr>
    <tr>
      <th>2015-04-08</th>
      <td>37.799999</td>
      <td>38.779999</td>
      <td>37.740002</td>
      <td>38.709999</td>
      <td>29.073900</td>
      <td>1649200</td>
    </tr>
    <tr>
      <th>2015-04-09</th>
      <td>38.759998</td>
      <td>40.000000</td>
      <td>38.349998</td>
      <td>39.990002</td>
      <td>30.035278</td>
      <td>1911600</td>
    </tr>
    <tr>
      <th>2015-04-10</th>
      <td>40.180000</td>
      <td>40.410000</td>
      <td>39.560001</td>
      <td>40.400002</td>
      <td>30.343212</td>
      <td>1269000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='exercise-2'></a></p>
<blockquote>
<div><p>See exercise 3 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
<div class="section" id="accessing-date-properties">
<h2><span class="section-number">6.8.6. </span>Accessing Date Properties<a class="headerlink" href="#accessing-date-properties" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, we would like to directly access a part of the date/time.</p>
<p>If our date/time information is in the index, we can to <code class="docutils literal notranslate"><span class="pre">df.index.XX</span></code>
where <code class="docutils literal notranslate"><span class="pre">XX</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, or whatever we would
like to access.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013,
            ...
            2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021, 2021],
           dtype=&#39;int64&#39;, name=&#39;Date&#39;, length=2071)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([25, 26, 27, 28,  1,  4,  5,  6,  7,  8,
            ...
             3,  4,  5,  6,  7, 10, 11, 12, 13, 14],
           dtype=&#39;int64&#39;, name=&#39;Date&#39;, length=2071)
</pre></div>
</div>
</div>
</div>
<p>We can also do the same if the date/time information is stored in a
column, but we have to use a slightly different syntax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">XX</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme_date_column</span> <span class="o">=</span> <span class="n">gme</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">gme_date_column</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2013-02-25</td>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2013-02-26</td>
      <td>24.770000</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013-02-27</td>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2013-02-28</td>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-03-01</td>
      <td>24.639999</td>
      <td>24.850000</td>
      <td>23.950001</td>
      <td>24.049999</td>
      <td>16.991102</td>
      <td>3525900</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme_date_column</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2013
1    2013
2    2013
3    2013
4    2013
Name: Date, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme_date_column</span><span class="p">[</span><span class="s2">&quot;Date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2
1    2
2    2
3    2
4    3
Name: Date, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="leads-and-lags-df-shift">
<h2><span class="section-number">6.8.7. </span>Leads and Lags: <code class="docutils literal notranslate"><span class="pre">df.shift</span></code><a class="headerlink" href="#leads-and-lags-df-shift" title="Permalink to this headline">¶</a></h2>
<p>When doing time series analysis, we often want to compare data at one
date against data at another date.</p>
<p>pandas can help us with this if we leverage the <code class="docutils literal notranslate"><span class="pre">shift</span></code> method.</p>
<p>Without any additional arguments, <code class="docutils literal notranslate"><span class="pre">shift()</span></code> will move all data
<em>forward</em> one period, filling the first row with missing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># so we can see the result of shift clearly</span>
<span class="n">gme</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>24.770000</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>24.639999</td>
      <td>24.850000</td>
      <td>23.950001</td>
      <td>24.049999</td>
      <td>16.991102</td>
      <td>3525900</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700.0</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.770000</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500.0</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800.0</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use this to compute the percent change from one day to the next.
(Quiz: Why does that work? Remember how pandas uses the index to <em>align</em>
data.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="n">gme</span><span class="o">.</span><span class="n">Close</span> <span class="o">-</span> <span class="n">gme</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span> <span class="o">/</span> <span class="n">gme</span><span class="o">.</span><span class="n">Close</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date
2013-02-25         NaN
2013-02-26    0.007314
2013-02-27    0.018152
2013-02-28   -0.007132
2013-03-01   -0.040303
Name: Close, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Setting the first argument to <code class="docutils literal notranslate"><span class="pre">n</span></code> tells pandas to shift the data down
<code class="docutils literal notranslate"><span class="pre">n</span></code> rows (apply an <code class="docutils literal notranslate"><span class="pre">n</span></code> period lag).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>25.09</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700.0</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>24.77</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A negative value will shift the data <em>up</em> or apply a lead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800.0</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600.0</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.639999</td>
      <td>24.850000</td>
      <td>23.950001</td>
      <td>24.049999</td>
      <td>16.991102</td>
      <td>3525900.0</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>23.959999</td>
      <td>24.070000</td>
      <td>23.360001</td>
      <td>23.540001</td>
      <td>16.630795</td>
      <td>3299800.0</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>23.780001</td>
      <td>24.360001</td>
      <td>23.670000</td>
      <td>24.299999</td>
      <td>17.167728</td>
      <td>3472000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-05-10</th>
      <td>145.699997</td>
      <td>150.500000</td>
      <td>142.229996</td>
      <td>144.789993</td>
      <td>144.789993</td>
      <td>2731500.0</td>
    </tr>
    <tr>
      <th>2021-05-11</th>
      <td>147.440002</td>
      <td>169.949997</td>
      <td>146.429993</td>
      <td>164.500000</td>
      <td>164.500000</td>
      <td>8860800.0</td>
    </tr>
    <tr>
      <th>2021-05-12</th>
      <td>147.440002</td>
      <td>166.429993</td>
      <td>156.229996</td>
      <td>163.884995</td>
      <td>163.884995</td>
      <td>2270087.0</td>
    </tr>
    <tr>
      <th>2021-05-13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2021-05-14</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='exercise-3'></a></p>
<blockquote>
<div><p>See exercise 4 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
<div class="section" id="rolling-computations-rolling">
<h2><span class="section-number">6.8.8. </span>Rolling Computations: <code class="docutils literal notranslate"><span class="pre">.rolling</span></code><a class="headerlink" href="#rolling-computations-rolling" title="Permalink to this headline">¶</a></h2>
<p>pandas has facilities that enable easy computation of <em>rolling
statistics</em>.</p>
<p>These are best understood by example, so we will dive right in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first take only the first 6 rows so we can easily see what is going on</span>
<span class="n">gme_small</span> <span class="o">=</span> <span class="n">gme</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">gme_small</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>24.770000</td>
      <td>25.219999</td>
      <td>23.780001</td>
      <td>24.790001</td>
      <td>17.321712</td>
      <td>2680500</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.709999</td>
      <td>25.389999</td>
      <td>24.629999</td>
      <td>25.240000</td>
      <td>17.636143</td>
      <td>3451800</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>25.320000</td>
      <td>25.660000</td>
      <td>25.049999</td>
      <td>25.059999</td>
      <td>17.510372</td>
      <td>2698600</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>24.639999</td>
      <td>24.850000</td>
      <td>23.950001</td>
      <td>24.049999</td>
      <td>16.991102</td>
      <td>3525900</td>
    </tr>
    <tr>
      <th>2013-03-04</th>
      <td>23.959999</td>
      <td>24.070000</td>
      <td>23.360001</td>
      <td>23.540001</td>
      <td>16.630795</td>
      <td>3299800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Below, we compute the 2 day moving average (for all columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme_small</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>25.090000</td>
      <td>25.200001</td>
      <td>24.610001</td>
      <td>24.610001</td>
      <td>17.195938</td>
      <td>1538700.0</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>24.930000</td>
      <td>25.210000</td>
      <td>24.195001</td>
      <td>24.700001</td>
      <td>17.258825</td>
      <td>2109600.0</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>24.739999</td>
      <td>25.304999</td>
      <td>24.205000</td>
      <td>25.015000</td>
      <td>17.478928</td>
      <td>3066150.0</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>25.015000</td>
      <td>25.524999</td>
      <td>24.839999</td>
      <td>25.149999</td>
      <td>17.573258</td>
      <td>3075200.0</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>24.979999</td>
      <td>25.255000</td>
      <td>24.500000</td>
      <td>24.554999</td>
      <td>17.250737</td>
      <td>3112250.0</td>
    </tr>
    <tr>
      <th>2013-03-04</th>
      <td>23.959999</td>
      <td>24.070000</td>
      <td>23.360001</td>
      <td>23.540001</td>
      <td>16.630795</td>
      <td>3299800.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To do this operation, pandas starts at each row (date) then looks
<em>backwards</em> the specified number of periods (here 2 days) and then
applies some aggregation function (<code class="docutils literal notranslate"><span class="pre">mean</span></code>) on all the data in that
window.</p>
<p>If pandas cannot look back the full length of the window (e.g. when
working on the first row), it fills as much of the window as possible
and then does the operation. Notice that the value at 2013-02-25 is
the same in both DataFrames.</p>
<p>Below, we see a visual depiction of the rolling maximum on a 21 day
window for the whole dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">gme</span><span class="p">[</span><span class="s2">&quot;Open&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">gme</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;21d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s2">&quot;Open&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;21 day max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x29728d123a0&gt;
</pre></div>
</div>
<img alt="../../_images/timeseries_61_1.png" src="../../_images/timeseries_61_1.png" />
</div>
</div>
<p>We can also ask pandas to <code class="docutils literal notranslate"><span class="pre">apply</span></code> custom functions, similar to what we
saw when studying GroupBy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_volatile</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="s2">&quot;Returns a 1 if the variance is greater than 1, otherwise returns 0&quot;</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gme_small</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_volatile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-02-25</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2013-02-26</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-02-27</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-02-28</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-03-01</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-03-04</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><a id='exercise-4'></a></p>
<blockquote>
<div><p>See exercise 5 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
<p>To make the optimal decision, we need to know the maximum
difference between the close price at the end of the window and the open
price at the start of the window.</p>
<p><a id='exercise-5'></a></p>
<blockquote>
<div><p>See exercise 6 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
</div>
<div class="section" id="changing-frequencies-resample-opt">
<h2><span class="section-number">6.8.9. </span>Changing Frequencies: <code class="docutils literal notranslate"><span class="pre">.resample</span></code> (Opt)<a class="headerlink" href="#changing-frequencies-resample-opt" title="Permalink to this headline">¶</a></h2>
<p>In addition to computing rolling statistics, we can also change the
frequency of the data.</p>
<p>For example, instead of a monthly moving average, suppose that we wanted
to compute the average <em>within</em> each calendar month.</p>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">resample</span></code> method to do this.</p>
<p>Below are some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># business quarter</span>
<span class="n">gme</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;BQ&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-03-29</th>
      <td>25.094583</td>
      <td>25.565417</td>
      <td>24.737500</td>
      <td>25.247083</td>
      <td>17.804623</td>
      <td>2.547904e+06</td>
    </tr>
    <tr>
      <th>2013-06-28</th>
      <td>35.254844</td>
      <td>36.019219</td>
      <td>34.700781</td>
      <td>35.398437</td>
      <td>25.081355</td>
      <td>4.000192e+06</td>
    </tr>
    <tr>
      <th>2013-09-30</th>
      <td>47.824062</td>
      <td>48.547031</td>
      <td>47.145469</td>
      <td>47.809063</td>
      <td>34.124808</td>
      <td>2.185230e+06</td>
    </tr>
    <tr>
      <th>2013-12-31</th>
      <td>51.333750</td>
      <td>51.968750</td>
      <td>50.496250</td>
      <td>51.277344</td>
      <td>36.793633</td>
      <td>2.739705e+06</td>
    </tr>
    <tr>
      <th>2014-03-31</th>
      <td>38.387869</td>
      <td>39.046885</td>
      <td>37.721147</td>
      <td>38.420984</td>
      <td>27.729402</td>
      <td>4.613946e+06</td>
    </tr>
    <tr>
      <th>2014-06-30</th>
      <td>39.208889</td>
      <td>39.785555</td>
      <td>38.583651</td>
      <td>39.152540</td>
      <td>28.531126</td>
      <td>2.880822e+06</td>
    </tr>
    <tr>
      <th>2014-09-30</th>
      <td>42.605938</td>
      <td>43.127188</td>
      <td>41.989375</td>
      <td>42.523750</td>
      <td>31.254489</td>
      <td>2.490878e+06</td>
    </tr>
    <tr>
      <th>2014-12-31</th>
      <td>38.776094</td>
      <td>39.396875</td>
      <td>38.087969</td>
      <td>38.687188</td>
      <td>28.659051</td>
      <td>3.475708e+06</td>
    </tr>
    <tr>
      <th>2015-03-31</th>
      <td>37.669344</td>
      <td>38.290000</td>
      <td>36.985246</td>
      <td>37.606721</td>
      <td>28.047138</td>
      <td>2.333562e+06</td>
    </tr>
    <tr>
      <th>2015-06-30</th>
      <td>41.116825</td>
      <td>41.542381</td>
      <td>40.632381</td>
      <td>41.114603</td>
      <td>30.952014</td>
      <td>1.663257e+06</td>
    </tr>
    <tr>
      <th>2015-09-30</th>
      <td>44.430469</td>
      <td>44.998750</td>
      <td>43.783906</td>
      <td>44.450625</td>
      <td>33.737740</td>
      <td>1.832997e+06</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>38.615468</td>
      <td>39.206094</td>
      <td>37.986094</td>
      <td>38.613125</td>
      <td>29.577585</td>
      <td>2.436550e+06</td>
    </tr>
    <tr>
      <th>2016-03-31</th>
      <td>28.676230</td>
      <td>29.254754</td>
      <td>28.027213</td>
      <td>28.744754</td>
      <td>22.269426</td>
      <td>2.692589e+06</td>
    </tr>
    <tr>
      <th>2016-06-30</th>
      <td>29.325000</td>
      <td>29.673750</td>
      <td>28.912344</td>
      <td>29.273594</td>
      <td>22.931337</td>
      <td>2.996278e+06</td>
    </tr>
    <tr>
      <th>2016-09-30</th>
      <td>29.172656</td>
      <td>29.548594</td>
      <td>28.799844</td>
      <td>29.147344</td>
      <td>23.131279</td>
      <td>2.645439e+06</td>
    </tr>
    <tr>
      <th>2016-12-30</th>
      <td>24.723651</td>
      <td>25.053651</td>
      <td>24.372857</td>
      <td>24.693333</td>
      <td>19.897113</td>
      <td>2.621148e+06</td>
    </tr>
    <tr>
      <th>2017-03-31</th>
      <td>24.392097</td>
      <td>24.711452</td>
      <td>24.092742</td>
      <td>24.429193</td>
      <td>19.942297</td>
      <td>3.041840e+06</td>
    </tr>
    <tr>
      <th>2017-06-30</th>
      <td>22.596825</td>
      <td>22.871270</td>
      <td>22.269048</td>
      <td>22.570476</td>
      <td>18.733855</td>
      <td>2.856003e+06</td>
    </tr>
    <tr>
      <th>2017-09-29</th>
      <td>20.702540</td>
      <td>20.940159</td>
      <td>20.494286</td>
      <td>20.702857</td>
      <td>17.478657</td>
      <td>2.341198e+06</td>
    </tr>
    <tr>
      <th>2017-12-29</th>
      <td>18.730635</td>
      <td>18.973492</td>
      <td>18.430159</td>
      <td>18.643175</td>
      <td>16.077245</td>
      <td>3.221259e+06</td>
    </tr>
    <tr>
      <th>2018-03-30</th>
      <td>16.367213</td>
      <td>16.623770</td>
      <td>16.079672</td>
      <td>16.316393</td>
      <td>14.359803</td>
      <td>4.234367e+06</td>
    </tr>
    <tr>
      <th>2018-06-29</th>
      <td>13.661250</td>
      <td>13.944219</td>
      <td>13.407031</td>
      <td>13.701719</td>
      <td>12.345799</td>
      <td>5.435038e+06</td>
    </tr>
    <tr>
      <th>2018-09-28</th>
      <td>15.309524</td>
      <td>15.593651</td>
      <td>15.021111</td>
      <td>15.326667</td>
      <td>14.140045</td>
      <td>3.359917e+06</td>
    </tr>
    <tr>
      <th>2018-12-31</th>
      <td>14.017778</td>
      <td>14.324921</td>
      <td>13.716984</td>
      <td>13.990794</td>
      <td>13.236171</td>
      <td>2.968770e+06</td>
    </tr>
    <tr>
      <th>2019-03-29</th>
      <td>12.418033</td>
      <td>12.644918</td>
      <td>12.207377</td>
      <td>12.424098</td>
      <td>12.084542</td>
      <td>3.756507e+06</td>
    </tr>
    <tr>
      <th>2019-06-28</th>
      <td>7.830635</td>
      <td>7.967460</td>
      <td>7.684762</td>
      <td>7.817937</td>
      <td>7.817937</td>
      <td>5.591121e+06</td>
    </tr>
    <tr>
      <th>2019-09-30</th>
      <td>4.319062</td>
      <td>4.471875</td>
      <td>4.191562</td>
      <td>4.316875</td>
      <td>4.316875</td>
      <td>8.051314e+06</td>
    </tr>
    <tr>
      <th>2019-12-31</th>
      <td>5.834687</td>
      <td>6.021562</td>
      <td>5.693594</td>
      <td>5.868125</td>
      <td>5.868125</td>
      <td>4.423612e+06</td>
    </tr>
    <tr>
      <th>2020-03-31</th>
      <td>4.289677</td>
      <td>4.469355</td>
      <td>4.119355</td>
      <td>4.280484</td>
      <td>4.280484</td>
      <td>3.828005e+06</td>
    </tr>
    <tr>
      <th>2020-06-30</th>
      <td>4.613016</td>
      <td>4.846032</td>
      <td>4.385873</td>
      <td>4.612540</td>
      <td>4.612540</td>
      <td>4.024198e+06</td>
    </tr>
    <tr>
      <th>2020-09-30</th>
      <td>5.728438</td>
      <td>6.034844</td>
      <td>5.520469</td>
      <td>5.780156</td>
      <td>5.780156</td>
      <td>6.680786e+06</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>13.727656</td>
      <td>14.500781</td>
      <td>13.176094</td>
      <td>13.763750</td>
      <td>13.763750</td>
      <td>1.207240e+07</td>
    </tr>
    <tr>
      <th>2021-03-31</th>
      <td>122.863933</td>
      <td>142.475902</td>
      <td>101.349344</td>
      <td>118.085575</td>
      <td>118.085575</td>
      <td>4.534800e+07</td>
    </tr>
    <tr>
      <th>2021-06-30</th>
      <td>163.540001</td>
      <td>170.854193</td>
      <td>156.169354</td>
      <td>163.093385</td>
      <td>163.093385</td>
      <td>6.857677e+06</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that unlike with <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, a single number is returned for
each column for each quarter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">resample</span></code> method will alter the frequency of the data and the
number of rows in the result will be different from the number of rows
in the input.</p>
<p>On the other hand, with <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, the size and frequency of the result
are the same as the input.</p>
<p>We can sample at other frequencies and aggregate with multiple aggregations
function at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># multiple functions at 2 start-of-quarter frequency</span>
<span class="n">gme</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;2BQS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Open</th>
      <th colspan="2" halign="left">High</th>
      <th colspan="2" halign="left">Low</th>
      <th colspan="2" halign="left">Close</th>
      <th colspan="2" halign="left">Adj Close</th>
      <th colspan="2" halign="left">Volume</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>23.780001</td>
      <td>41.410000</td>
      <td>24.070000</td>
      <td>42.840000</td>
      <td>23.360001</td>
      <td>41.119999</td>
      <td>23.540001</td>
      <td>42.029999</td>
      <td>16.630795</td>
      <td>29.939573</td>
      <td>1203200</td>
      <td>13867200</td>
    </tr>
    <tr>
      <th>2013-07-01</th>
      <td>42.000000</td>
      <td>57.680000</td>
      <td>42.340000</td>
      <td>57.740002</td>
      <td>41.660000</td>
      <td>56.919998</td>
      <td>42.169998</td>
      <td>57.590000</td>
      <td>30.039301</td>
      <td>41.250896</td>
      <td>626000</td>
      <td>14606000</td>
    </tr>
    <tr>
      <th>2014-01-01</th>
      <td>33.669998</td>
      <td>49.709999</td>
      <td>34.380001</td>
      <td>50.000000</td>
      <td>33.099998</td>
      <td>49.070000</td>
      <td>33.830002</td>
      <td>49.650002</td>
      <td>24.370848</td>
      <td>35.767437</td>
      <td>1317800</td>
      <td>23506700</td>
    </tr>
    <tr>
      <th>2014-07-01</th>
      <td>32.110001</td>
      <td>46.060001</td>
      <td>32.730000</td>
      <td>46.590000</td>
      <td>31.809999</td>
      <td>45.860001</td>
      <td>31.920000</td>
      <td>46.099998</td>
      <td>23.756634</td>
      <td>33.791782</td>
      <td>1102800</td>
      <td>18761100</td>
    </tr>
    <tr>
      <th>2015-01-01</th>
      <td>32.549999</td>
      <td>44.580002</td>
      <td>33.709999</td>
      <td>45.500000</td>
      <td>31.690001</td>
      <td>44.160000</td>
      <td>32.270000</td>
      <td>44.549999</td>
      <td>24.017122</td>
      <td>33.735287</td>
      <td>747200</td>
      <td>8682800</td>
    </tr>
    <tr>
      <th>2015-07-01</th>
      <td>28.370001</td>
      <td>47.619999</td>
      <td>28.799999</td>
      <td>47.830002</td>
      <td>27.900000</td>
      <td>46.900002</td>
      <td>28.040001</td>
      <td>47.439999</td>
      <td>21.640425</td>
      <td>35.923729</td>
      <td>746100</td>
      <td>16933800</td>
    </tr>
    <tr>
      <th>2016-01-01</th>
      <td>25.059999</td>
      <td>33.200001</td>
      <td>25.450001</td>
      <td>33.720001</td>
      <td>24.330000</td>
      <td>33.099998</td>
      <td>25.059999</td>
      <td>33.380001</td>
      <td>19.340549</td>
      <td>26.056412</td>
      <td>1264900</td>
      <td>22220500</td>
    </tr>
    <tr>
      <th>2016-07-01</th>
      <td>20.590000</td>
      <td>32.130001</td>
      <td>20.920000</td>
      <td>32.669998</td>
      <td>20.100000</td>
      <td>31.830000</td>
      <td>20.730000</td>
      <td>32.160000</td>
      <td>16.610323</td>
      <td>25.432758</td>
      <td>1031700</td>
      <td>14493400</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>20.330000</td>
      <td>26.330000</td>
      <td>20.660000</td>
      <td>26.680000</td>
      <td>20.240000</td>
      <td>26.020000</td>
      <td>20.459999</td>
      <td>26.520000</td>
      <td>17.093769</td>
      <td>21.566963</td>
      <td>1151100</td>
      <td>15944600</td>
    </tr>
    <tr>
      <th>2017-07-03</th>
      <td>16.010000</td>
      <td>22.200001</td>
      <td>16.379999</td>
      <td>22.370001</td>
      <td>15.850000</td>
      <td>21.900000</td>
      <td>16.000000</td>
      <td>22.170000</td>
      <td>13.707144</td>
      <td>18.619781</td>
      <td>972900</td>
      <td>20500700</td>
    </tr>
    <tr>
      <th>2018-01-01</th>
      <td>12.510000</td>
      <td>19.920000</td>
      <td>12.750000</td>
      <td>20.309999</td>
      <td>12.200000</td>
      <td>19.770000</td>
      <td>12.460000</td>
      <td>19.959999</td>
      <td>11.151717</td>
      <td>17.439156</td>
      <td>1867000</td>
      <td>25824000</td>
    </tr>
    <tr>
      <th>2018-07-02</th>
      <td>11.720000</td>
      <td>16.980000</td>
      <td>12.020000</td>
      <td>17.270000</td>
      <td>11.560000</td>
      <td>16.620001</td>
      <td>11.670000</td>
      <td>17.040001</td>
      <td>11.287046</td>
      <td>15.660386</td>
      <td>1289300</td>
      <td>17471600</td>
    </tr>
    <tr>
      <th>2019-01-01</th>
      <td>4.980000</td>
      <td>16.020000</td>
      <td>5.130000</td>
      <td>16.900000</td>
      <td>4.710000</td>
      <td>15.880000</td>
      <td>5.020000</td>
      <td>15.980000</td>
      <td>5.020000</td>
      <td>15.455612</td>
      <td>1282000</td>
      <td>39354200</td>
    </tr>
    <tr>
      <th>2019-07-01</th>
      <td>3.250000</td>
      <td>6.650000</td>
      <td>3.360000</td>
      <td>6.920000</td>
      <td>3.150000</td>
      <td>6.390000</td>
      <td>3.210000</td>
      <td>6.680000</td>
      <td>3.210000</td>
      <td>6.680000</td>
      <td>1369000</td>
      <td>34005000</td>
    </tr>
    <tr>
      <th>2020-01-01</th>
      <td>2.850000</td>
      <td>6.210000</td>
      <td>2.940000</td>
      <td>6.470000</td>
      <td>2.570000</td>
      <td>6.070000</td>
      <td>2.800000</td>
      <td>6.310000</td>
      <td>2.800000</td>
      <td>6.310000</td>
      <td>1467600</td>
      <td>13506600</td>
    </tr>
    <tr>
      <th>2020-07-01</th>
      <td>3.900000</td>
      <td>21.309999</td>
      <td>4.050000</td>
      <td>22.350000</td>
      <td>3.770000</td>
      <td>20.350000</td>
      <td>3.850000</td>
      <td>20.990000</td>
      <td>3.850000</td>
      <td>20.990000</td>
      <td>1330100</td>
      <td>77152800</td>
    </tr>
    <tr>
      <th>2021-01-01</th>
      <td>17.340000</td>
      <td>379.709991</td>
      <td>18.080000</td>
      <td>483.000000</td>
      <td>17.080000</td>
      <td>262.269989</td>
      <td>17.250000</td>
      <td>347.510010</td>
      <td>17.250000</td>
      <td>347.510010</td>
      <td>1789200</td>
      <td>197157900</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As with <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and <code class="docutils literal notranslate"><span class="pre">rolling</span></code>, you can also provide custom
functions to <code class="docutils literal notranslate"><span class="pre">.resample(...).agg</span></code> and <code class="docutils literal notranslate"><span class="pre">.resample(...).apply</span></code></p>
<p><a id='exercise-6'></a></p>
<blockquote>
<div><p>See exercise 7 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
<p>To make the optimal decision we need to, for each month,
compute the maximum value of the close price on any day minus the open
price on the first day of the month.</p>
<p><a id='exercise-7'></a></p>
<blockquote>
<div><p>See exercise 8 in the <a class="reference external" href="#exerciselist-0"><em>exercise list</em></a></p>
</div></blockquote>
<p>(<a class="reference external" href="#exercise-7"><em>back to text</em></a>)</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="groupby.html" title="previous page"><span class="section-number">6.7. </span>GroupBy (opt)</a>
    <a class='right-next' id="next-link" href="matplotlib.html" title="next page"><span class="section-number">6.9. </span>Intermediate Plotting (opt)</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alan Moreira<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>